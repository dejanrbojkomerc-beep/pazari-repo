
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pazari poslednja 3 dana</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="refresh" content="300">
    <style>
        :root {
            --border: #ddd;
            --muted: #666;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 12px;
        }
        h2 {
            margin: 16px 0 8px 0;
            font-size: 18px;
        }
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border: 1px solid var(--border);
            border-radius: 8px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            min-width: 720px;
        }
        th, td {
            border: 1px solid var(--border);
            padding: 8px;
            text-align: right;
            white-space: nowrap;
        }
        th {
            background-color: #f5f5f5;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        td:first-child, th:first-child {
            text-align: left;
            position: sticky;
            left: 0;
            z-index: 2;
            background: #fff;
        }
        tr:nth-child(even) { background-color: #fafafa; }
        tr:last-child { font-weight: bold; background-color: #e6f7ff; }
        .cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 16px;
        }
        .card {
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px;
            background: #fff;
        }
        .card canvas {
            width: 100% !important;
            height: 460px !important;
        }
        .legend-note {
            color: var(--muted);
            font-size: 12px;
            margin-top: 4px;
        }
        @media (min-width: 900px) {
            .cards { grid-template-columns: 1fr 1fr; }
        }
        @media (max-width: 600px) {
            body { font-size: 14px; }
            th, td { padding: 6px; }
        }
    </style>
</head>
<body>
    <h2>Pazari za poslednja 3 dana</h2>
    <div class="table-wrapper">
        <table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">2025-12-29</th>
      <th colspan="2" halign="left">2025-12-28</th>
      <th colspan="2" halign="left">2025-12-27</th>
    </tr>
    <tr>
      <th></th>
      <th>Pazar</th>
      <th>Broj računa</th>
      <th>Pazar</th>
      <th>Broj računa</th>
      <th>Pazar</th>
      <th>Broj računa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TC_Beo</th>
      <td>609,527.85</td>
      <td>224</td>
      <td>884,193.39</td>
      <td>300</td>
      <td>766,558.90</td>
      <td>274</td>
    </tr>
    <tr>
      <th>Arandjelovac</th>
      <td>617,311.82</td>
      <td>213</td>
      <td>615,190.53</td>
      <td>258</td>
      <td>920,618.43</td>
      <td>334</td>
    </tr>
    <tr>
      <th>Aviv</th>
      <td>377,994.34</td>
      <td>134</td>
      <td>372,976.29</td>
      <td>144</td>
      <td>296,604.45</td>
      <td>127</td>
    </tr>
    <tr>
      <th>BW_Galerija</th>
      <td>915,399.22</td>
      <td>225</td>
      <td>1,164,820.35</td>
      <td>271</td>
      <td>1,165,812.53</td>
      <td>273</td>
    </tr>
    <tr>
      <th>Banjica</th>
      <td>488,896.10</td>
      <td>205</td>
      <td>52,854.66</td>
      <td>41</td>
      <td>270,855.72</td>
      <td>137</td>
    </tr>
    <tr>
      <th>Borca</th>
      <td>958,967.92</td>
      <td>297</td>
      <td>828,733.33</td>
      <td>282</td>
      <td>652,119.21</td>
      <td>255</td>
    </tr>
    <tr>
      <th>Gornji_Milanovac</th>
      <td>359,827.51</td>
      <td>122</td>
      <td>230,565.77</td>
      <td>133</td>
      <td>380,659.33</td>
      <td>170</td>
    </tr>
    <tr>
      <th>Kalenic</th>
      <td>180,548.33</td>
      <td>77</td>
      <td>125,652.07</td>
      <td>43</td>
      <td>136,320.45</td>
      <td>55</td>
    </tr>
    <tr>
      <th>Karaburma</th>
      <td>354,951.35</td>
      <td>130</td>
      <td>440,892.47</td>
      <td>184</td>
      <td>464,831.37</td>
      <td>185</td>
    </tr>
    <tr>
      <th>Knez</th>
      <td>331,233.39</td>
      <td>119</td>
      <td>194,004.83</td>
      <td>83</td>
      <td>279,649.88</td>
      <td>98</td>
    </tr>
    <tr>
      <th>Leskovac</th>
      <td>510,109.42</td>
      <td>213</td>
      <td>324,532.15</td>
      <td>149</td>
      <td>431,412.77</td>
      <td>180</td>
    </tr>
    <tr>
      <th>Loznica</th>
      <td>502,752.38</td>
      <td>198</td>
      <td>570,590.73</td>
      <td>200</td>
      <td>402,896.91</td>
      <td>179</td>
    </tr>
    <tr>
      <th>Mladenovac</th>
      <td>401,489.05</td>
      <td>196</td>
      <td>381,898.15</td>
      <td>191</td>
      <td>557,514.90</td>
      <td>220</td>
    </tr>
    <tr>
      <th>NS_Bulevar</th>
      <td>457,726.04</td>
      <td>170</td>
      <td>37,152.54</td>
      <td>18</td>
      <td>330,405.28</td>
      <td>118</td>
    </tr>
    <tr>
      <th>NS_Sajam</th>
      <td>430,987.78</td>
      <td>158</td>
      <td>73,566.78</td>
      <td>37</td>
      <td>476,802.64</td>
      <td>143</td>
    </tr>
    <tr>
      <th>Nis</th>
      <td>1,379,523.52</td>
      <td>475</td>
      <td>1,496,533.88</td>
      <td>517</td>
      <td>1,359,049.19</td>
      <td>496</td>
    </tr>
    <tr>
      <th>Pancevo</th>
      <td>1,006,752.45</td>
      <td>371</td>
      <td>826,184.98</td>
      <td>310</td>
      <td>888,088.32</td>
      <td>348</td>
    </tr>
    <tr>
      <th>Paracin</th>
      <td>416,268.68</td>
      <td>138</td>
      <td>17,881.71</td>
      <td>6</td>
      <td>252,863.10</td>
      <td>69</td>
    </tr>
    <tr>
      <th>Pozarevac</th>
      <td>606,706.41</td>
      <td>223</td>
      <td>589,417.19</td>
      <td>210</td>
      <td>566,112.14</td>
      <td>203</td>
    </tr>
    <tr>
      <th>Stadion</th>
      <td>626,527.96</td>
      <td>248</td>
      <td>746,728.62</td>
      <td>315</td>
      <td>806,276.23</td>
      <td>303</td>
    </tr>
    <tr>
      <th>Subotica</th>
      <td>437,531.62</td>
      <td>152</td>
      <td>331,837.86</td>
      <td>164</td>
      <td>381,325.20</td>
      <td>174</td>
    </tr>
    <tr>
      <th>Surcin</th>
      <td>491,971.62</td>
      <td>175</td>
      <td>601,620.30</td>
      <td>196</td>
      <td>576,729.18</td>
      <td>205</td>
    </tr>
    <tr>
      <th>Valjevo</th>
      <td>418,146.96</td>
      <td>174</td>
      <td>587,130.80</td>
      <td>264</td>
      <td>511,904.37</td>
      <td>209</td>
    </tr>
    <tr>
      <th>Vrbas</th>
      <td>411,730.41</td>
      <td>146</td>
      <td>256,777.77</td>
      <td>100</td>
      <td>304,949.42</td>
      <td>144</td>
    </tr>
    <tr>
      <th>Vrsac</th>
      <td>420,776.62</td>
      <td>146</td>
      <td>306,374.11</td>
      <td>125</td>
      <td>416,164.10</td>
      <td>160</td>
    </tr>
    <tr>
      <th>Zajecar</th>
      <td>531,831.55</td>
      <td>214</td>
      <td>492,044.75</td>
      <td>223</td>
      <td>400,210.79</td>
      <td>189</td>
    </tr>
    <tr>
      <th>Zemun</th>
      <td>477,795.42</td>
      <td>143</td>
      <td>181,193.32</td>
      <td>50</td>
      <td>359,643.04</td>
      <td>116</td>
    </tr>
    <tr>
      <th>Ukupno</th>
      <td>14,723,285.72</td>
      <td>5286</td>
      <td>12,731,349.33</td>
      <td>4814</td>
      <td>14,356,377.85</td>
      <td>5364</td>
    </tr>
  </tbody>
</table>
    </div>

    <div class="cards">
        <div class="card">
            <h2>Pazar po satima (poslednja 3 dana)</h2>
            <canvas id="salesByHour"></canvas>
            <div class="legend-note">X: sat (0–23) • Y: pazar (RSD)</div>
        </div>
        <div class="card">
            <h2>Broj računa po satima (poslednja 3 dana)</h2>
            <canvas id="receiptsByHour"></canvas>
            <div class="legend-note">X: sat (0–23) • Y: broj računa</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    const mkChart = (canvasId, datasets, yTitle) => {
        const ctx = document.getElementById(canvasId);
        return new Chart(ctx, {
            type: 'bar',
            data: {
                labels: [...Array(24).keys()],
                datasets: datasets
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            label: (item) => {
                                const val = item.parsed.y || 0;
                                if (yTitle.includes("RSD")) {
                                    return `${item.dataset.label}: ` + val.toLocaleString('sr-RS');
                                }
                                return `${item.dataset.label}: ` + val;
                            }
                        }
                    }
                },
                scales: {
                    x: { title: { display: true, text: "Sat" } },
                    y: { title: { display: true, text: yTitle } }
                }
            }
        });
    };
    const datasetsPazar = [{"label": "2025-12-29 - Pazar", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6140.83, 240094.63, 601853.91, 943918.61, 1144953.52, 1295956.7, 1275675.02, 1375766.89, 1565321.03, 1632210.14, 1824875.19, 1531154.3499999999, 991266.39, 294098.51, 0.0, 0.0], "borderColor": "#4CAF50", "backgroundColor": "#4CAF50", "borderWidth": 2}, {"label": "2025-12-28 - Pazar", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 113831.39, 552238.3099999999, 1076110.06, 1388193.08, 1553930.84, 1460562.31, 1475702.1199999999, 1290517.94, 1206155.1099999999, 1114160.29, 892467.84, 434836.87, 172499.18, 143.99, 0.0], "borderColor": "#FF5722", "backgroundColor": "#FF5722", "borderWidth": 2}, {"label": "2025-12-27 - Pazar", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6031.969999999999, 183331.05, 610894.94, 1330843.07, 1629879.56, 1606971.86, 1501146.3699999999, 1519604.8699999999, 1395570.68, 1322416.51, 1125363.1099999999, 1142442.55, 752337.75, 229543.56, 0.0, 0.0], "borderColor": "#2196F3", "backgroundColor": "#2196F3", "borderWidth": 2}];
    const datasetsRacuni = [{"label": "2025-12-29 - Broj ra\u010duna", "data": [0, 0, 0, 0, 0, 0, 0, 0, 12, 96, 233, 366, 390, 442, 498, 475, 554, 590, 624, 533, 377, 96, 0, 0], "borderColor": "#4CAF50", "backgroundColor": "#4CAF50", "borderWidth": 2}, {"label": "2025-12-28 - Broj ra\u010duna", "data": [0, 0, 0, 0, 0, 0, 0, 0, 8, 56, 228, 421, 524, 596, 540, 527, 460, 438, 399, 363, 196, 57, 1, 0], "borderColor": "#FF5722", "backgroundColor": "#FF5722", "borderWidth": 2}, {"label": "2025-12-27 - Broj ra\u010duna", "data": [0, 0, 0, 0, 0, 0, 0, 0, 3, 98, 260, 447, 581, 602, 561, 537, 525, 495, 447, 427, 287, 94, 0, 0], "borderColor": "#2196F3", "backgroundColor": "#2196F3", "borderWidth": 2}];
    mkChart('salesByHour', datasetsPazar, 'Iznos (RSD)');
    mkChart('receiptsByHour', datasetsRacuni, 'Broj računa');
    </script>
</body>
</html>
