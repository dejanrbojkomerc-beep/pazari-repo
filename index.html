
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pazari poslednja 3 dana</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="refresh" content="300">
    <style>
        :root {
            --border: #ddd;
            --muted: #666;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 12px;
        }
        h2 {
            margin: 16px 0 8px 0;
            font-size: 18px;
        }
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border: 1px solid var(--border);
            border-radius: 8px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            min-width: 720px;
        }
        th, td {
            border: 1px solid var(--border);
            padding: 8px;
            text-align: right;
            white-space: nowrap;
        }
        th {
            background-color: #f5f5f5;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }
        td:first-child, th:first-child {
            text-align: left;
            position: sticky;
            left: 0;
            z-index: 2;
            background: #fff;
        }
        tr:nth-child(even) { background-color: #fafafa; }
        tr:last-child { font-weight: bold; background-color: #e6f7ff; }
        .cards {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-top: 16px;
        }
        .card {
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px;
            background: #fff;
        }
        .card canvas {
            width: 100% !important;
            height: 460px !important;  /* visoki stubovi */
        }
        .legend-note {
            color: var(--muted);
            font-size: 12px;
            margin-top: 4px;
        }
        @media (min-width: 900px) {
            .cards { grid-template-columns: 1fr 1fr; }
        }
        @media (max-width: 600px) {
            body { font-size: 14px; }
            th, td { padding: 6px; }
        }
    </style>
</head>
<body>
    <h2>Pazari za poslednja 3 dana</h2>
    <div class="table-wrapper">
        <table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">2025-12-26</th>
      <th colspan="2" halign="left">2025-12-25</th>
      <th colspan="2" halign="left">2025-12-24</th>
    </tr>
    <tr>
      <th></th>
      <th>Pazar</th>
      <th>Broj računa</th>
      <th>Pazar</th>
      <th>Broj računa</th>
      <th>Pazar</th>
      <th>Broj računa</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TC_Beo</th>
      <td>66,739.38</td>
      <td>26</td>
      <td>359,569.86</td>
      <td>148</td>
      <td>341,804.36</td>
      <td>137</td>
    </tr>
    <tr>
      <th>Aviv</th>
      <td>80,126.29</td>
      <td>30</td>
      <td>112,506.39</td>
      <td>62</td>
      <td>155,273.16</td>
      <td>72</td>
    </tr>
    <tr>
      <th>BW_Galerija</th>
      <td>163,113.19</td>
      <td>32</td>
      <td>688,340.29</td>
      <td>168</td>
      <td>656,853.68</td>
      <td>147</td>
    </tr>
    <tr>
      <th>Banjica</th>
      <td>85,303.88</td>
      <td>47</td>
      <td>206,607.41</td>
      <td>132</td>
      <td>158,034.28</td>
      <td>126</td>
    </tr>
    <tr>
      <th>Borca</th>
      <td>137,160.92</td>
      <td>44</td>
      <td>351,329.72</td>
      <td>156</td>
      <td>347,097.28</td>
      <td>97</td>
    </tr>
    <tr>
      <th>Gornji_Milanovac</th>
      <td>33,226.71</td>
      <td>22</td>
      <td>144,213.24</td>
      <td>67</td>
      <td>153,940.86</td>
      <td>71</td>
    </tr>
    <tr>
      <th>Kalenic</th>
      <td>35,575.69</td>
      <td>15</td>
      <td>125,905.77</td>
      <td>50</td>
      <td>79,722.18</td>
      <td>37</td>
    </tr>
    <tr>
      <th>Karaburma</th>
      <td>59,607.30</td>
      <td>26</td>
      <td>219,581.63</td>
      <td>103</td>
      <td>220,434.52</td>
      <td>98</td>
    </tr>
    <tr>
      <th>Knez</th>
      <td>74,167.03</td>
      <td>31</td>
      <td>170,027.28</td>
      <td>69</td>
      <td>145,859.42</td>
      <td>55</td>
    </tr>
    <tr>
      <th>Leskovac</th>
      <td>65,013.81</td>
      <td>29</td>
      <td>301,526.11</td>
      <td>119</td>
      <td>266,229.02</td>
      <td>123</td>
    </tr>
    <tr>
      <th>Loznica</th>
      <td>83,893.53</td>
      <td>31</td>
      <td>215,257.83</td>
      <td>103</td>
      <td>251,303.58</td>
      <td>106</td>
    </tr>
    <tr>
      <th>Mladenovac</th>
      <td>76,738.32</td>
      <td>31</td>
      <td>204,211.56</td>
      <td>95</td>
      <td>226,564.44</td>
      <td>142</td>
    </tr>
    <tr>
      <th>NS_Bulevar</th>
      <td>71,334.12</td>
      <td>36</td>
      <td>342,262.08</td>
      <td>91</td>
      <td>203,835.43</td>
      <td>78</td>
    </tr>
    <tr>
      <th>NS_Sajam</th>
      <td>135,022.49</td>
      <td>39</td>
      <td>283,433.98</td>
      <td>99</td>
      <td>375,797.29</td>
      <td>108</td>
    </tr>
    <tr>
      <th>Nis</th>
      <td>150,333.62</td>
      <td>60</td>
      <td>1,141,474.35</td>
      <td>385</td>
      <td>998,856.07</td>
      <td>320</td>
    </tr>
    <tr>
      <th>Pancevo</th>
      <td>120,492.82</td>
      <td>58</td>
      <td>634,171.32</td>
      <td>212</td>
      <td>659,938.05</td>
      <td>224</td>
    </tr>
    <tr>
      <th>Paracin</th>
      <td>80,206.53</td>
      <td>22</td>
      <td>162,591.34</td>
      <td>65</td>
      <td>146,719.63</td>
      <td>54</td>
    </tr>
    <tr>
      <th>Pozarevac</th>
      <td>130,111.76</td>
      <td>37</td>
      <td>376,584.12</td>
      <td>158</td>
      <td>259,704.25</td>
      <td>104</td>
    </tr>
    <tr>
      <th>Stadion</th>
      <td>83,910.01</td>
      <td>42</td>
      <td>465,043.30</td>
      <td>190</td>
      <td>396,995.40</td>
      <td>150</td>
    </tr>
    <tr>
      <th>Subotica</th>
      <td>114,810.51</td>
      <td>45</td>
      <td>400,221.95</td>
      <td>135</td>
      <td>603,446.11</td>
      <td>221</td>
    </tr>
    <tr>
      <th>Surcin</th>
      <td>105,812.45</td>
      <td>32</td>
      <td>369,469.43</td>
      <td>136</td>
      <td>243,826.02</td>
      <td>101</td>
    </tr>
    <tr>
      <th>Valjevo</th>
      <td>79,377.31</td>
      <td>29</td>
      <td>378,556.04</td>
      <td>144</td>
      <td>384,770.15</td>
      <td>132</td>
    </tr>
    <tr>
      <th>Vrbas</th>
      <td>47,780.58</td>
      <td>41</td>
      <td>204,271.48</td>
      <td>110</td>
      <td>236,616.81</td>
      <td>84</td>
    </tr>
    <tr>
      <th>Vrsac</th>
      <td>37,182.01</td>
      <td>18</td>
      <td>303,712.71</td>
      <td>121</td>
      <td>286,634.53</td>
      <td>109</td>
    </tr>
    <tr>
      <th>Zajecar</th>
      <td>105,831.25</td>
      <td>37</td>
      <td>238,472.68</td>
      <td>112</td>
      <td>291,029.49</td>
      <td>102</td>
    </tr>
    <tr>
      <th>Zemun</th>
      <td>115,214.28</td>
      <td>34</td>
      <td>251,657.45</td>
      <td>80</td>
      <td>213,108.30</td>
      <td>67</td>
    </tr>
    <tr>
      <th>Ukupno</th>
      <td>2,338,085.79</td>
      <td>894</td>
      <td>8,650,999.32</td>
      <td>3310</td>
      <td>8,304,394.31</td>
      <td>3065</td>
    </tr>
  </tbody>
</table>
    </div>

    <div class="cards">
        <div class="card">
            <h2>Pazar po satima (poslednja 3 dana)</h2>
            <canvas id="salesByHour"></canvas>
            <div class="legend-note">X: sat (0–23) • Y: pazar (RSD)</div>
        </div>
        <div class="card">
            <h2>Broj računa po satima (poslednja 3 dana)</h2>
            <canvas id="receiptsByHour"></canvas>
            <div class="legend-note">X: sat (0–23) • Y: broj računa</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    const mkChart = (canvasId, datasets, yTitle) => {
        const ctx = document.getElementById(canvasId);
        return new Chart(ctx, {
            type: 'bar',  // stubovi
            data: {
                labels: [...Array(24).keys()], // 0–23
                datasets: datasets
            },
            options: {
                responsive: true,
                maintainAspectRatio: false, // koristi CSS visinu
                interaction: { mode: 'index', intersect: false },
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            label: (item) => {
                                const val = item.parsed.y || 0;
                                if (yTitle.includes("RSD")) {
                                    return `${item.dataset.label}: ` + val.toLocaleString('sr-RS');
                                }
                                return `${item.dataset.label}: ` + val;
                            }
                        }
                    }
                },
                scales: {
                    x: { title: { display: true, text: "Sat" } },
                    y: { title: { display: true, text: yTitle } }
                }
            }
        });
    };
    const datasetsPazar = [{"label": "2025-12-26 - Pazar", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15496.81, 181510.55, 431205.0, 716709.46, 893717.13, 99446.84, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "borderColor": "#4CAF50", "backgroundColor": "#4CAF50", "borderWidth": 2}, {"label": "2025-12-25 - Pazar", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7940.76, 240650.4, 437476.83999999997, 530987.62, 736993.94, 776195.15, 804679.03, 851917.98, 884873.82, 989378.28, 959689.19, 836004.63, 443093.27, 151118.41, 0.0, 0.0], "borderColor": "#FF5722", "backgroundColor": "#FF5722", "borderWidth": 2}, {"label": "2025-12-24 - Pazar", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1199.93, 182131.76, 456121.49, 621800.6, 746652.74, 683032.9, 634772.36, 751929.89, 757340.37, 906782.37, 988955.5599999999, 799942.21, 551552.04, 222180.09, 0.0, 0.0], "borderColor": "#2196F3", "backgroundColor": "#2196F3", "borderWidth": 2}];
    const datasetsRacuni = [{"label": "2025-12-26 - Broj ra\u010duna", "data": [0, 0, 0, 0, 0, 0, 0, 0, 7, 83, 180, 287, 305, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], "borderColor": "#4CAF50", "backgroundColor": "#4CAF50", "borderWidth": 2}, {"label": "2025-12-25 - Broj ra\u010duna", "data": [0, 0, 0, 0, 0, 0, 0, 0, 6, 76, 197, 234, 266, 282, 315, 282, 313, 340, 370, 365, 199, 61, 3, 1], "borderColor": "#FF5722", "backgroundColor": "#FF5722", "borderWidth": 2}, {"label": "2025-12-24 - Broj ra\u010duna", "data": [0, 0, 0, 0, 0, 0, 0, 0, 6, 82, 174, 233, 256, 272, 263, 284, 297, 317, 334, 305, 185, 57, 0, 0], "borderColor": "#2196F3", "backgroundColor": "#2196F3", "borderWidth": 2}];
    mkChart('salesByHour', datasetsPazar, 'Iznos (RSD)');
    mkChart('receiptsByHour', datasetsRacuni, 'Broj računa');
    </script>
</body>
</html>
